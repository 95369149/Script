{"config":"{\"icon\":\"bolt.badge.automatic.fill\",\"color\":{\"red\":51,\"alpha\":0.7982832618025751,\"blue\":50,\"green\":203},\"name\":\"链接转换\"}","main":"/**\n * @typedef {import(\"../../action\").Action} Action\n */\nclass MyAction extends Action {\n    #component\n\n    get component() {\n        if (!this.#component) {\n            const url = String(this.text);\n            const path = url.substring(url.indexOf(\"/\", \"https://\".length) + 1);\n            this.#component = path.split(\"/\");\n        }\n        return this.#component;\n    }\n\n    l10n() {\n        return {\n            \"zh-Hans\": {\n                \"openLink.nourl\": \"未检测到GitHub链接\",\n                \"linkAlreadyEdited\": \"链接已转换为编辑状态\"\n            },\n            en: {\n                \"openLink.nourl\": \"No GitHub link detected\",\n                \"linkAlreadyEdited\": \"Link already converted to edit state\"\n            }\n        }\n    }\n\n\n    processGistRawUrl(url) {\n        const regex = /https:\\/\\/gist\\.githubusercontent\\.com\\/(.+)\\/raw\\/[0-9a-f]+\\/(.+)/;\n        const match = url.match(regex);\n        if (match && match.length === 3) {\n            return `https://gist.githubusercontent.com/${match[1]}/raw/${match[2]}`;\n        }\n        return url;\n    }\n\n    githubusercontent() {\n        const user = this.component[0],\n            repository = this.component[1],\n            branch = this.component[2],\n            file = this.component.slice(3).join(\"/\");\n        return `https://github.com/${user}/${repository}/blob/${branch}/${file}`;\n    }\n\n    github() {\n        const user = this.component[0],\n            repository = this.component[1],\n            blob = this.component[2],\n            branch = this.component[3],\n            file = this.component.slice(4).join(\"/\");\n        return `https://raw.githubusercontent.com/${user}/${repository}/${branch}/${file}`;\n    }\n\n    do() {\n        let result = String(this.text);\n\n        // 检查链接是否已转换为 'edit' 形式\n        if (result.includes(\"script.hub/edit/\")) {\n            $ui.warning($l10n(\"linkAlreadyEdited\"));\n            return;\n        }\n\n        if (result.includes(\"script.hub/file/\") || result.includes(\"script.hub/convert/\")) {\n            result = result.replace(\"script.hub/file/\", \"script.hub/edit/\");\n            result = result.replace(\"script.hub/convert/\", \"script.hub/edit/\");\n        } else if (result.includes(\"raw.githubusercontent.com\")) {\n            result = this.githubusercontent(result);\n        } else if (result.includes(\"github.com\")) {\n            if (result.includes(\"?raw=true\")) {\n                result = result.replace(\"?raw=true\", \"\");\n            } else {\n                result = this.github();\n            }\n        } else if (result.includes(\"gist.githubusercontent.com\")) {\n            result = this.processGistRawUrl(result);\n        } else {\n            $ui.warning($l10n(\"openLink.nourl\"));\n            return;\n        }\n\n        $ui.success($l10n(\"COPIED\"));\n        $clipboard.text = result;\n    }\n}","readme":"## RawRepoConverter\r\n\r\nGithub Raw 链接和 Script Hub 链接转换器\r\n"}